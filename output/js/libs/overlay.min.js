!function(e,t){"function"==typeof define&&define.amd?define("Overlay",t(e)):"object"==typeof exports?module.exports=t(e):e.Overlay=t(e)}(this,function(e){"use strict";function t(){var e,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e]}function n(e){var t=O(),n=t.indexOf(document.activeElement);e.shiftKey&&0===n?(y.focus(),e.preventDefault()):e.shiftKey||n!==t.length-1||(v.focus(),e.preventDefault())}var o,i,r,a,s,d,c,l,u,m,d,f,v,y,h,b={},g=!1,p=t(),E=document.addEventListener&&void 0===p;navigator.userAgent.match(/(iPad|iPhone|iPod)/i)&&(document.documentElement.className+=" device-ios"),navigator.userAgent.match(/android/i)&&(document.documentElement.className+=" device-android");var L=document.createElement("div");L.className="scrollbar-measure",document.body.appendChild(L);var k=L.offsetWidth-L.clientWidth;0===k?document.documentElement.className+=" hiddenscroll":document.documentElement.className+=" no-hiddenscroll",document.body.removeChild(L);var w={triggerElement:null,closeClass:".overlay_close-btn",hideElements:"#content-main, .mast-header, .mast-footer",beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}},A=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},C=function(){var e=o.triggerElement;document.getElementsByTagName("body")[0].clientHeight>window.innerHeight;"string"==typeof e||e instanceof String?(m=document.getElementById(e),d=m):(m=e,d=e),i=m.hasAttribute("data-overlay-keyClose")?m.getAttribute("data-overlay-keyClose"):"true",r=m.hasAttribute("data-overlay-bgClose")?m.getAttribute("data-overlay-bgClose"):"true",c=m.hasAttribute("data-overlay-closeBtn")?m.getAttribute("data-overlay-closeBtn"):"true",u=document.getElementById(m.getAttribute("aria-controls")),s=u.querySelector(".overlay_bg"),a=u.querySelector(".overlay_dialog"),g=document.querySelectorAll(o.hideElements),f=O(),"true"===c&&(l=u.querySelector(o.closeClass),l.addEventListener("click",T,!1)),"true"===r&&(a.addEventListener("click",T,!1),s.addEventListener("click",T,!1)),document.addEventListener("keydown",T,!0),window.addEventListener("resize",T,!1)},O=function(){var e=a.querySelectorAll("a[href],button:not([disabled]),area[href],input:not([disabled]):not([type=hidden]),select:not([disabled]),textarea:not([disabled]),iframe,object,embed,*:not(.is-draggabe)[tabindex],*[contenteditable]"),t=[].slice.call(e);return y=t[t.length-1],v=t[0],t},T=function(e){var t=e.type,o=e.target,r=e.currentTarget,d=e.keyCode,c=e.which;return!!h&&("click"===t&&(r!==l&&o!==a&&o!==s||(b.close(),e.stopPropagation())),"keydown"===t&&(27==d&&"true"===i&&b.close(),9===c&&n(e)),void("resize"===t&&N()))},H=function(e,t,n){var o;return function(){function i(){n||e.apply(r,a),o=null}var r=this,a=arguments;o?clearTimeout(o):n&&e.apply(r,a),o=setTimeout(i,t||100)}},N=H(function(){var e=a.offsetHeight,t=window.innerHeight;e>=t?u.classList.add("is-anchored"):u.classList.remove("is-anchored")},250),S=function(e){"open"===e?(a.offsetHeight>window.innerHeight&&u.classList.add("is-anchored"),u.classList.add("is-open"),h=!0,document.body.classList.add("overlay-open")):"close"===e&&(u.setAttribute("aria-hidden","true"),h=!1,document.body.classList.remove("overlay-open"))},q=function(){u.setAttribute("aria-hidden","false");for(var e=g.length-1;e>=0;e--)g[e].setAttribute("aria-hidden","true");S("open")},x=function(){u.classList.remove("is-open","is-anchored");for(var e=g.length-1;e>=0;e--)g[e].removeAttribute("aria-hidden");S("close")};return b.destroy=function(){o&&("true"===c&&l.removeEventListener("click",T,!1),"true"===r&&(a.removeEventListener("click",T,!1),s.removeEventListener("click",T,!1)),document.removeEventListener("keydown",T,!0),window.removeEventListener("resize",T,!1),i=r=a=d=s=c=l=u=m=d=f=v=y=h=p=E=null,o=null)},b.open=function(e){b.destroy(),o=A(w,e),o.beforeOpen(),C(),q(),N(),o.afterOpen(),O(),v.focus()},b.close=function(){o.beforeClose(),x(),o.afterClose(),console.log(d),d.focus()},b});